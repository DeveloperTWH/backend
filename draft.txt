12-06-2025 env setup, database creation and connection , Models creation , controller creation, mcv arch

13-06-2025 Developed business and product listing models along with their respective category, subcategory, review, and offer management schemas to support a scalable multi-vendor marketplace architecture, and improvised the user registration API to handle additional details such as gender and phone number.

16-06-2025 rate limiting done and soft listing of api for understanding and soft listing of database models with schema for better understanding

16-06-2025 added start script init

16-06-2025 cors made according to render

16-06-2025 added review and subscription model outlined

17-06-2025 business creation api, updation,deletion,listing api created and tested by postman

18-06-2025 Created the subscription creation API, developed the product creation API, implemented the isAdmin middleware, wrote product validation logic, added the product route, and finalized the business creation API ensuring each business has a unique subscription.

18-06-2025 Created the subscription creation API, developed the product creation API, implemented the isAdmin middleware, wrote product validation logic, added the product route, and finalized the business creation API ensuring each business has a unique subscription.

19-06-2025 product variant creation api completed

19-06-2025 product creation api with cloudinary upload,business creationn api with cloudinary image upload , subscription creation api , node- corn job created which will delete the image which is not asociated with any of the product or product variant.

20-06-2025 Variant creation Route , Variant updation Route and Variant Deletion Route Configured, Developed Variant Creation API, Developed Variant Updation API, Developed Variant Deletion API, Postman Testing Under Process

23-06-2025 developed Product Deletion and Variant associated with product Deletion api tested Variant Creation API, Variant Updation API, and Variant Deletion API in Postman

24-06-2025 Developed Service creation api, Developed Service Updation api, Developed Service Deletion api, Developed Service Listing Api, Configured routes for all of the above api, Tested All the …
…Api's with the Postman

25-06-2025 User Mangement Module:
Integrated Minority type Api With The frontend dropdown list in Service and food page, Developed User Mangement Module, Developed Listing api (public percpctive),Developed Listing api (Admin percpctive), Developed User Updation api, Developed User Deletion api, developed api to block and unblock user from the platform.

FAQs Module
Developed FAQs model, Configured FAQ specific routes, Developed FAQ listing Api (Admin percpctive), Developed FAQ Creation api, developed FAQ Updation Api, Developed FAQ Deletion api, Configured CMS Routes to Get FAQs from the db

26-06-2025 testimonial Module
Developed testimonial model, Configured testimonial specific routes, Developed testimonial listing Api (Admin percepctive), Developed testimonial Creation api, developed testimonial Updation Api, Developed testimonial Deletion api, Configured CMS Routes to Get testimonial from the db

wishlist Module
Developed wishlist model, Configured wishlist specific routes, Developed wishlist listing Api (Only Authenticated Customer), Developed wishlist Creation api, Developed product removing api from the wishlist.

27-06-2025 Blog Module:
Developed Blog Model, Configured Blog specific Routes, Developed Blog Listing Api (Admin percepctive), Developed Get Specific Blog Api (Admin percepctive), Developed Blog Listing Api (public percepctive), Developed Get Specific Blog Api (Public percepctive), Developed Blog Creation Api, Developed Blog Updation Api, Developed Blog Deletion Api, Developed Blog Feature/UnFeature Toggle Api, Developed Blog Publish/UnPublish Toggle Api

30-06-2025 add cookies and developed logout api to delete httponly cookie to logout

01-07-2025 developed and styled the complete business registration form with dynamic plan selection, file uploads (logo and cover image), and integrated form submission with loading and feedback ha…
…ndling, structured the routing to redirect users to `/partners` (Business Owner Dashboard) after registration and created the `/partners/[businessid]/setup` page to handle bank details.Developed the bank details UI based on the provided figma Design, fixed a TypeScript warning

02-07-2025 implemented slug generation, location support (address + coordinates), and verifying all core APIs including create, update, delete, and get my services, Developed new get service by ID …
…Api.tested everything on Postman with sample data

03-07-2025 worked on service schema automatically update ratings when a Review is added/updated

04-07-2025 Product Order payment Module:
Created Address Model to Store the saved address, Created Order model To store the orders done by the user with products, quantity and total price ..etc, Created Refund Model, Developed orderController to creted order on sucessfull payment, Developed Webhook to chcek the Payment Status. configured routes for the Product Order, Payment, Webhook's.

07-07-2025 Today, you worked on implementing and debugging the Stripe webhook to handle events like checkout.session.completed. You ensured signature verification by using express.raw() for the…
… webhook route and added detailed debugging logs to track the raw request and identify any errors. You created a Stripe Checkout session, processed it by retrieving the BusinessDraft, and used its data to create a Subscription and Business. Additionally, you handled the 500 error by logging the process step-by-step and ensured proper error handling, all while testing the webhook with Stripe CLI to simulate events.

08-07-2025 Today, we implemented the retryCreateBusiness API to allow business creation from an existing subscription, integrated Stripe Checkout and payment validation, and tested the Stripe web…
…hook using the CLI. We also fixed TypeScript errors related to subscription types, displayed both new and existing subscription plans in the frontend with tab functionality, and ensured redirection to `/partners` on successful business creation. Additionally, we added subscription checks to ensure business creation only for completed payments.

09-07-2025 Developed api to fetch the existing Subscription paln of the user
Configured routes for fetching existing Subscription paln of the user
Developed Api To get all the categories from the db realted to the Food,service,product
configured route for it,
Updated Business Creation api to work without the logo and coverImage.
updated Stripe webhook so paymet can be verifed and business can be creted without the logo and coover imnage
developed retry mechanisum to crete the business from existing subscriptiion.
configured routes and tested with stripe cli

10-07-2025 
Today, I completed several backend and frontend tasks including implementing secure token storage using HttpOnly cookies, creating business listing APIs with filters and pagination, and …
…integrating them into the VendorGrid component with debounced search and a loading spinner. I refactored the ServiceCategory and ProductCategory models to auto-generate slugs, enhanced the service listing API with comprehensive filtering and sorting, and integrated it into the ServicePage. Additionally, I resolved routing conflicts by separating the service detail and category listing routes, ensuring seamless navigation and proper image loading from Cloudinary and AWS S3.

11-07-2025

 Frontend (Next.js / TypeScript):

    Integrated Get Service by Slug API (`/api/public/services/:slug`) on the Service Detail page.
    Displayed service details and reviews dynamically instead of using static data.
    Corrected TypeScript types for `Service` and `Review`, and created an API response interface.
    Handled Loading and Not Found states using Loader2 and AlertTriangle icons.
    Converted phone, email, and website fields into clickable `tel:`, `mailto:`, and external links.
    Connected to the Service List API (`/api/services/list`) for category-based listing.
    Fixed query parameter mismatches (`searchText → search`, `location → city`).
    Implemented Search button functionality to fetch services on click.
    Showed/hid the `<CategoryGrid />` component based on active filter values.
    Embedded Google Maps iframe for the selected service's address in the map sidebar.


 Backend (Node.js / Express / Mongoose):

    Enhanced the Service List API (`/api/services/list`) to support:

    categorySlug → categoryId conversion
    search, city, minorityType filters
    sorting by price, rating, and reviews.
    Developed the Get Service by Slug API to:

    Fetch the service by slug
    Fetch and include related reviews
    
    Ensured category-based filtering works correctly by querying `ServiceCategory` using the slug.

14-07-2025

   Developed the main Product Page with category and product listings (static fetching).

   Developed the Business Dashboard page with key metric cards and visuals.

   Built the SalesSection component with bar, pie, and line charts using recharts.

   Enabled pie chart hover behavior with scale and value popover effect.

   Styled the Order Status section with inner color ring and custom legend.

   Updated next.config.js to allow image loading from external domains.


   Developed Main Product Page With categories and product, Made Routing perfect, Developed the Business Dashboard page with key metric cards and visuals, Built the SalesSection component with bar, pie, and line charts using recharts, Enabled pie chart hover behavior with scale and value popover effect, Styledwith inner color ring and custom legend, Updated next.config.js to allow image loading from external domains

15-07-2025

   1. Made the sidebar responsive, ensuring it collapses on mobile and remains static on desktop, with a working hamburger menu for toggling.

   2. Adjusted the Topbar for mobile responsiveness by implementing a hamburger menu and hiding the search bar on smaller screens.

   3. Resolved the issue of excessive left padding in the `LineChart`, ensuring it adapts correctly across all screen sizes.

   4. Made The sidebar, Topbar, OverviewCards, SalesSection, SubscriptionPlan, ProductTable responsive 

16-07-2025

   API Creation:

      Created the getBusinessBySlug API.

      Created the following routes for fetching business-related data:

      /services/list - Fetch all private services for a business (including unpublished).

      /services/:slug - Fetch a specific service for a business (including unpublished).

      /food/list - Fetch all food/products for a business (including unpublished).

      /products/list - Fetch all products for a business (including unpublished).

      /food/list - Fetch all food/products for a business (Only Published).

      /products/list - Fetch all products for a business (Only Published).

   Frontend Development:

      Created the loading screen and the not found screen for product and food listings.

      Developed the Review and Rating component.

      Developed the TopSelling MapComponent to display geospatial data of the business.

      Made the Business Owner Dashboard responsive.

17-07-2025

   Updated Product API

      Flattened sizes to size-level records.
      Added `salePrice` and `sizeId`.
      Included Product Out of Stock and `sellableCount` in API response.

   Updated Business API

      Populated `subscriptionPlan` inside `subscription`.
      Returned business, subscription, and subscriptionPlan as separate objects.

   Frontend Enhancements

      Displayed dynamic subscription & subscription plan details in the dashboard.
      Updated Product Table to show `salePrice`, stock status, and dynamic counts (`total`, `sellableCount`).
      Added skeleton loader and error state for better UX.

   Planning for Inventory Page

      Decided to create `/partners/[businessid]/inventory`.
      Will fetch business data by slug to get `listingType` dynamically.

18-07-2025

   Developed Inventory Page with full dynamic support for Products, Services, and Food based on listingType.

   Integrated Product/Service/Food fetching logic with withCredentials for secure API calls.

   Introduced global state using Zustand to store business data and reduce repeated API calls.

   Implemented logic to check cached business (compares store slug with URL slug, clears & fetches if different).

   Improved Loading & Error UI – Added spinner loader and styled alert boxes.

   Added 3 Overview Boxes (Total, Available, Out Of Stock/Unpublished) with responsive grid design.

   Converted Add Button to a Next.js Link, dynamically using businessid from URL.

   Made Inventory Page responsive across all devices.

   Added Logout Functionality in partner's sidebar.

   added Gender based Avtars in partner's tpbar

22-07-2025 

   Developed the Vendor Profile Page with proper layout and sections.

   Integrated backend API to fetch and display business-specific details dynamically.

   Displayed real business name in the sidebar and showed the first character of the business name as the logo image fallback.

   Made the Vendor Profile Page fully responsive for all screen sizes.

31-07-2025

   Created product grouping logic in backend to fetch grouped products with variants and sizes.

   Modified product listing API to match ProductListingItem type (includes size, pricing, ratings).

   Integrated product listing API on frontend to show real products.

   Handled Decimal128 conversion on backend to ensure proper numeric values for price/salePrice.

   Integrated discount visibility logic based on salePrice and discountEndDate.

   Added loading state handling for product and service listings.

   Fixed issue with image scaling (small image) using Tailwind adjustments.

05-08-2025

   Product Subcategory APIs
      GET /api/admin/category/product-subcategory – List all product subcategories

      POST /api/admin/category/product-subcategory – Create a product subcategory

      PUT /api/admin/category/product-subcategory/:id – Update a product subcategory

      DELETE /api/admin/category/product-subcategory/:id – Delete a product subcategory
      
   Service Category
      GET /api/admin/category/service – list all service categories

      POST /api/admin/category/service – create service category

      PUT /api/admin/category/service/:id – update category

      DELETE /api/admin/category/service/:id – delete category

   Food Category
      GET /api/admin/category/food – list all food categories

      POST /api/admin/category/food – create food category

      PUT /api/admin/category/food/:id – update category

      DELETE /api/admin/category/food/:id – delete category

   Handled default image fallback for missing category images.
   Made category cards fully clickable via Link.
   integrated all the api's in the Admin Dashboard categories management page

07-08-2025

   Created Booking Management Page in the Partner Dashboard to list all vendor bookings with filters.

   Integrated the listing API in the Booking Management Page to fetch vendor-specific bookings dynamically.

   Displayed customer info (name, email, phone), service title, booked items, time, and date.

   Displayed booking creation time using createdAt field from MongoDB.

   Implemented conditional action buttons based on booking status:

      Confirm (when status is Booked)

      Complete (when status is confirmed)

      Decline (visible unless status is completed)

   Integrated Confirm, Complete, and Decline APIs to update booking statuses in real-time.

11-08-2025

   Created new types related to orders (VariantSize, Variant, Product, Item, ShippingAddress, StatusHistory, Order) to ensure error-free rendering of order-related data on the Customer Order page.

   Added toast notifications for error handling.

   Developed a "No Orders" screen for when there are no orders to display.

   integrated backend Order api's to Dispaly the data of users

12-08-2025 
   1. Added Stripe Connect fields to Business model (account ID, charges/payouts flags, onboarding status).
   2. Built POST /api/connect/\:businessId/account-link (create/reuse Express account + onboarding link).
   3. Built GET /api/connect/\:businessId/status (sync charges/payouts/capabilities + status).
   4. Extended Stripe webhook with account.updated to keep onboarding state in sync.
   5. Implemented single-vendor initiateOrder with `transfer_data.destination` + `application_fee_amount`.
   6. Added idempotency + rich metadata to PaymentIntents.
   7. Updated webhook payment\_intent.succeeded to mark orders paid → ordered and store `chargeId`/`transferId`/`applicationFeeId`.
   8. Frontend: vendor dashboard shows Connect with Stripe, then Locked—waiting for approval, then full dashboard when approved.
   9. Frontend: vendors list page shows Connect button per business or Locked/“Go to Business” based on status.
   10. Fixed Invalid URL error by ensuring absolute `return_url` in frontend and robust URL handling in Connect flows.

13-08-2025 to 14

   1. Designed Stripe Connect flow: added account linking, status check, and gating business visibility until Connect is complete.
   2. Backend Connect endpoints: `POST /api/connect/:businessId/account-link`, `GET /api/connect/:businessId/status`, plus optional return/refresh handlers.
   3. Business model updates (discussed): fields for `stripeConnectAccountId`, `onboardingStatus`, `chargesEnabled`, `payoutsEnabled`, `onboardedAt`, `capabilities`.
   4. Fixed “Invalid URL: explicit scheme” errors by enforcing absolute HTTPS return/refresh URLs and robust URL builders.
   5. Clarified PaymentIntent strategies: cards-only vs. all methods with proper `return_url`; removed undefined vars (`buyerStripeCustomerId`, `buyerEmail`).
   6. Implemented single-vendor `initiateOrder` directing funds to vendors via `transfer_data.destination` and platform fee via `application_fee_amount`.
   7. Added idempotency keys and rich metadata to PaymentIntents.
   8. Webhook `payment_intent.succeeded`: mark orders paid→ordered; capture and store `chargeId` / `transferId` / `applicationFeeId`; fixed scope bug (`it` not defined) and added robust charge retrieval with expands.
   9. Frontend vendor dashboard updates: “Connect with Stripe” CTA, status banner, and “Locked — waiting for admin approval” logic.
   10. Vendors list page: per-business Connect status + CTA; show “Go to Business” when approved.
   11. Resolved frontend return\_url issue by building from `window.location.origin` / env and explaining when to omit it.
   12. Admin users API: returned counts `totalVendor`, `totalCustomer`, plus OTP verification counts (`otpVerified`, `otpUnverified`).
   13. Admin Users page: added stat cards (Vendors, Customers) and later a Verification card (Verified/Unverified) with Lucide icons; built users table UI.
   14. Admin orders API: `GET /admin/api/orders` with filters, pagination, and summaries for payment (`pending/paid/failed/refunded`) and status (created→refunded).
   15. Admin Orders page: top summary cards, status distribution chips, paginated orders table.

   planed: 
      16. Subscription plans: moved from hard-coded price map to Stripe-backed plans.
      17. Extended `SubscriptionPlan` schema with Stripe/billing fields (`stripeProductId`, `stripePriceId`, `currency`, `interval`, `intervalCount`, `trialPeriodDays`).
      18. Created helper `ensurePlanPrice` to lazily create Stripe Product + Price and persist IDs.
      19. Updated plan controllers: admin `create` auto-creates product/price; `update` creates a new Stripe Price when billing terms change; added list/get endpoints and admin routes.
      20. Checkout session now pulls plan from DB, ensures price, and uses `stripePriceId` (no more hard-coded maps).

20-08-2025 
   4. Created `PUT /update/:cartItemId` – `updateCartItem` API: Updates the quantity of an item in the cart, Checks stock availability and handles backorder support, Validates that the product and variant are valid and published.
   5. Created `DELETE /remove/:cartItemId` – `removeItemFromCart` API: Removes a specific item from the cart, Validates that the cart item belongs to the authenticated user, Updates the total items in the cart and deletes the CartItem document.

22-08-2025

   1. Created Product Mini API and Variant Mini API to fetch lightweight product/variant details (title, cover image, size-based pricing, etc.), enabling faster cart and order rendering.
   2. Enhanced guest cart enrichment by integrating the mini APIs to fetch product/variant details and ensure size-based pricing is handled correctly.
   3. Fixed a price display bug where product prices were incorrectly showing extra digits (e.g., `8500` instead of `850`).
   4. Updated the guest cart flow to correctly handle multiple products/variants and display accurate prices.
   5. Implemented the Place Order flow with shipping address state management, initiating the order via API, and redirecting to checkout/payment.
   6. Built and integrated an Address component, supporting saved addresses, selecting an existing one, and adding new addresses.
   7. Integrated the order initiation API in the Cart page with proper address mapping (`postalCode → pincode`) to match backend requirements.
   8. Improved the order listing page to display all items in an order, instead of only the first item.
   9. Added conditional tracking link visibility, shown only when an order is in `shipped` or `delivered` status.
   10. Implemented a Cancel Order button on the frontend for users to cancel orders with status `ordered` or `accepted`.
   11. Developed a backend cancelOrderByUser controller that: Validates cancellable statuses (`ordered`/`accepted`), Restores stock if already decremented, Issues a full Stripe refund (including reverse transfer and application fee refund), Updates order status/history
   12. Added the cancel order route (`POST /api/orders/:orderId/cancel`) in the backend.

26-08-2025 

   1. Fixed header with --header-h (ResizeObserver) and global padding to prevent overlap.
   2. Synced sticky offsets using top-[calc(var(--header-h)+…)].
   3. Installed @types/google.maps and typed google refs.
   4. Map UX: gestureHandling: "greedy", keyboardShortcuts: false; overlays unclipped via overflow-visible + ancestor unclip.
   5. Numbered SVG markers + safe InfoWindow; click pans/zooms to selection.
   6. Layout: lg:items-stretch, no self-start/h-full; viewport-based map height.
   7. Provided AffixSidebar for Yelp-style behavior (fixed while scrolling, stops at list end).
   8. Finalized manual vs “track current” address flow; set default coords \[0,0] only as fallback.
   9. Wired backend geocoding: if manual address, use Google Geocoding → save GeoJSON `[lng, lat]`.
   10. Reviewed schema/controller + helper; confirmed `geocodeAddress` integration & error handling.
   11. Built `AllServicesMap` (Google Maps JS API) to plot all services from API coords; auto fitBounds.
   12. Fixed TS issues (`google` namespace) using `/* global google */` and `window.google` access.
   13. Implemented right-side map panel layout; independent list scroll; attempted sticky, then added JS sticky polyfill.
   14. Added numbered markers, centered digits; highlight selected (bigger red) + InfoWindow (serial, title, address).
   15. Hooked marker clicks to parent (`onSelect`) → set active service & smooth-scroll to the matching card; fixed prop types and removed `h-[100vh]` wrappers.

27-08-2025

   1. Ranked endpoint weighted by subscription price (priority + weight).
   2. Weighted interleave across plans with safeguards (credit accrual, epsilon clamp).
   3. Per-vendor cap + soft backfill to avoid empty pages.
   4. Eligibility rules: product/variant published, stock/backorder check; active business & subscription.
   5. Debug mode: removedAtAggregation, removedByCap, notOnPage, and timings.
   6. Aggregation hardening: ObjectId validation, early $sort + $limit, minimal $lookup projections, { allowDiskUse, maxTimeMS }.
   7. Vendor meta: 5-min TTL cache, clamped weights, chunked subscription lookups.
   8. Ranking helpers hardened (baseScore guards; interleaver safety).
   9. Controller hardening: input clipping, fetchLimit = pageSize10, paginate after backfill.
   10. Fixed .maxTimeMS issue by using aggregate options; delivered a master feature prompt for future work.
   11. body Padding top bug removed now it will be only applied in the layout with the heder fixed.
   12. in index page hero section now add the btn loading blink effect till we get the login state of user if user not logedin btn visble in logedin not visble.
   13. Performed reconnaissance on https://crownstandard.ca Identified 4 potential security issues, reported findings for bug

28-08-2025

   1. Extended ranked Products aggregation to return firstEligible variant (price, salePrice, discountEndDate, onSale, effectivePrice, size, label, color, images, videos, rating rollups).
   2. Fixed sale logic: use `salePrice` only when `discountEndDate > now`; also return both base `price` and `salePrice`+`discountEndDate`.
   3. Updated ranked controller to accept/passthrough `excludeProductId`.
   4. Added Similar Products API (separate): `GET /api/products/:id/similar` with middleware that sets category/subcategory + `excludeProductId`.
   5. Integrated the SimilarProduct component with the new similar API (this task completed).
   6. Integrated ShopProducts with ranked API; added Swiper image slider with autoplay & compact pagination dots.
   7. Implemented equal-height product cards across slides; price row pinned to bottom.
   8. Added multi-line ellipsis (…) for titles/descriptions (safe word breaks).
   9. Hardened fetch: AbortController handling, loading skeletons, and retry UI.
   10. Resolved Mongo aggregation var issues and polished sale badge/discount UI.


02-09-2025

   1. Added seedBusinessId and vendorFirst to res.locals.similar: seedBusinessId carries the seed product’s vendor so the controller can detect same-vendor items, and vendorFirst (default true, override with ?vendorFirst=0) tells the controller to show a top block of same-vendor products (seed excluded, sorted by score) before interleaving the rest by plan weight (cap applies only to “others”).

03-09-2025

   1. Created the mailer utility function which uses Nodemailer to send Business Approved email when an admin approves (or re-approves after unblock) a business to owner + business emails (deduped), with CTA to /partners/{slug}.
   2. Created the mailer utility function which uses Nodemailer to send Business Blocked email when an admin blocks/disapproves a business to owner + business emails (deduped), optionally including the admin note/reason.
   3. Created the mailer utility function which uses Nodemailer to send Order Confirmed (Customer) email with PDF invoice when Stripe `payment_intent.succeeded` marks the order as paid to the customer (userId.email).
   4. Created the mailer utility function which uses Nodemailer to send Paid Order (Vendor) email with PDF invoice when Stripe `payment_intent.succeeded` marks the order as paid to the vendor/business (vendorId.email, businessId.email, businessId.owner.email; deduped).
   5. Attempted approval without completed onboarding → 400 response, no state change, no email.
   6. Blocked → approved (re-approval) → same Approved email with CTA /partners/{slug}.
   7. PDF invoice (PDFKit) → items (name/SKU/size/color/qty), unit & line totals, grand total from `totalAmount` (minor→major), clean layout.
   8. Branding & deliverability → CID logo, clear preheaders, `List-Unsubscribe` header, concise action-oriented copy.
   9. Integrated Service Category Api In the Service page to Display the Service Managed by Admin Dashboard

03-09-2025

   1. Mailer Utility – Built orderMailer.js using Nodemailer to send order status emails (accepted/rejected) with Mosaic logo, polite wording, and a “View My Orders” button.
   2. Reject Order Flow – Modified rejectOrder controller to trigger rejection email after saving the order and handle Stripe refund with correct vendor account.
   3. Stripe Fix – Corrected Stripe Connect account reference to ensure refunds are processed from the vendor’s connected account.
   4. Accept Order Flow – Modified acceptOrder controller to send acceptance email after stock adjustment and saving the order.
   5. Removed dummy address (John Doe) → no hard-coded default in production.
   6. Decided current flow → users must enter delivery details fresh each time (no saved addresses yet).  
   7. Fixed email code – added `axios`, made the Nodemailer transporter a singleton, and embedded the logo as a CID buffer so it always shows in inboxes.
   8. HTML → PDF invoices – swapped out PDFKit for Puppeteer; added `utils/pdfFromHtml.js` and a clean, branded template in `utils/invoiceHtml.js`.
   9. Invoice service – `services/invoiceService.js` renders a PDF from a populated order so any part of the app can reuse it.
   10. Invoice controller – `controllers/invoiceController.js` streams the PDF, handles inline vs download, and basic id validation.
   11. Download route – `GET /api/orders/:id/invoice.pdf?download=1` so customers/vendors can view or download their invoice directly.
   12. Totals fix – smart `toMajor(...)` auto-detects if `totalAmount` is minor or major (using subtotal as a hint) and `showAdj` is a boolean, keeping Subtotal/Adjustments/Grand Total accurate.


04-09-2025 

   mosaic-biz-hub : 

   1. Address Line 2 search: Hooked Google Places Autocomplete to addr2Ref and built a formatter (route/neighborhood/sublocality) so street/locality auto-fills; Address Line 1 stays manual (house/apt).
   2. Use my location: Added reverse-geocode via Google Geocoder on GPS coords to fill ZIP, city, state, country and compose Address Line 2 automatically.
   3. US-only enforcement: Scoped Autocomplete to country: ["US"] and, after selection/geocode, checked countryShort !== "US" → show alert, clear address fields, keep country fixed to “United States.”
   4. ZIP-first flow: Postal code comes first; when a valid US ZIP is typed we geocode it to auto-fill city/state. Non-US/invalid ZIPs are caught and cleared (with an alert).
   5. Slug → ID in backend: Controller now accepts categorySlug/subcategorySlug, looks up Mongo _id from your ProductCategory/ProductSubcategory models, then calls the existing service unchanged.
   6. Dynamic route on frontend: Read [productid] from the URL with useParams() and pass it as categorySlug so /furniture fetches that category directly.
   7. Fixed API call: Corrected path to /api/products/ranked and normalized NEXT_PUBLIC_API_BASE_URL (no double slashes); added query params via URLSearchParams.
   8. Grid wired to API: Replaced local JSON filter with a fetch to your RankedResponse; lightly filter client-side by price/brand before rendering.
   9. Accurate discount badge: Recomputed % off as ((price - sale)/price)100 (no integer rounding) and formatted to 1 decimal only when needed (e.g., -0.5%).
   10. Card UX polish: Kept drag-safe Swiper (no accidental clicks), clamped title/description lines, and showed price/rating consistently; optional sale badge appears when onSale is true.

   crown-standard : (Listed today as mentioned)

   1. Conducted a comprehensive review of Stripe payment flows for CrownStandard, focusing on marketplace/service scenarios and their implications for compliance, settlement timing, refunds, and financial reporting.

   2. Performed a comparative evaluation of Authorization (hold) versus Capture (settled) models, detailing impacts on fund availability, authorization expiry risk, operational processes, and customer experience.

   3. Adopted the payment strategy “Capture at checkout, transfer post-OTP”, selected for its timing flexibility, elimination of authorization-expiry exposure, and streamlined reconciliation.

   4. Defined the end-to-end OTP-gated fund release process: customer payment, service fulfillment, OTP verification, remittance of 75% to the provider, and retention of 25% as the platform fee.

   5. Standardized the use of `transfer_group` to associate the originating PaymentIntent/charge with all downstream transfers and potential reversals, ensuring traceability and auditability across the transaction lifecycle.

   6. Produced an upper-level architecture for the payment flow, identifying principal actors (Customer, Platform, Provider), core services (Checkout, Orders, OTP, Payments, Webhooks), relevant data stores, and the event sequence (Charge → Platform Balance → OTP Validation → Provider Transfer → Payout).

05-09-2025

   1. Added Finance link to Sidebar (partner dashboard) pointing to /partners/[businessId]/finance.
   2. Created Finance page (finance/page.tsx) with embedded Stripe Connect components: Payments + Payouts.
   3. Styled Finance page: quick stats cards (Next Payout (ETA), Available Balance, Pending Balance) and a sticky “Open Connect Dashboard” button.
   4. Wired Finance page to external backend (apiBase) and added guards to prevent init before business data is ready.
   5. Implemented Finance backend endpoints used by the page:

      POST /stripe/account-session (Connect AccountSession client secret for components)
      GET  /stripe/account-balance?account=...
      GET  /stripe/last-payout?account=...
      POST /stripe/express-login-link (opens Connect Dashboard)
   6. Fixed JSON/content-type issues and added withCredentials where needed for external API calls.
   7. Explained/test-mode behavior for balances and U.S. default payout timing (T+2 business days).
   8. Added stripeCustomerId to Business model (+ index).
   9. Updated Stripe webhook (checkout.session.completed) to save session.customer → business.stripeCustomerId and backfill when subscription already linked.
   10. Built POST /stripe/backfill-customers to populate missing stripeCustomerId (supports batching / all).
   11. Updated TypeScript Business interface to include optional stripeCustomerId.
   12. Created /api endpoints for Subscription & Billing (external backend):

      GET  /api/subscriptions/current?businessId=...
      POST /api/subscriptions/:id/cancel (body: businessId, atPeriodEnd)
      POST /api/subscriptions/:id/resume (body: businessId)
      POST /api/billing-portal/session (body: businessId, resolves customer server-side)
   13. Refactored My Account page to use those endpoints via apiBase, including withCredentials.
   14. Hooked up Open Billing Portal on My Account to call ${apiBase}/api/billing-portal/session with businessId.
   15. Secured API routes with authenticate and isBusinessOwner middlewares (expects businessId in query/body).
   16. Finalized approach: one Stripe customer per business (supports vendors with multiple businesses cleanly).

08-09-2025

   1. Category & subcategory slugs: API now accepts categorySlug/subcategorySlug, resolves them to IDs, and backfills category from sub when needed.
   2. Active subscriptions only: Products show only if the vendor’s subscription is active and endDate > now (expired subs hidden).
   3. DB-side filtering: fetchEligibleProducts filters by brand (regex), minorityType (regex), and size (matches sizes.size) directly in Mongo, not just in UI.
   4. URL-driven search state: Product page reads query params on load and navigation, so Back/Forward cycles through prior searches correctly.
   5. Minority type by name: URLs like ?minorityType=African%20Americans are supported; client maps name → ID before fetching.
   6. FilterSidebar updates: Added Subcategory dropdown, kept Brand and Size, removed Color since vendors store hex codes.
   7. Subcategory data flow: Parent fetches subcategories for the current category and passes them into the sidebar for the dropdown.
   8. API-bound filters from client: Client sends subcategorySlug, brand, minorityType, size to /api/ranked; only price range is filtered client-side.
   9. New list APIs: Added /api/categories and /api/subcategories to power the dropdowns (optional q and categorySlug support).
   10. Cleanups: Fixed categorySlug typo, standardized route to /api/subcategories, and removed stray console log.
   11. Integrated getLoggedInCustomer in Navbar, added isCustomer state, and updated menus to show Orders + Logout for customers, Dashboard + Logout for others.
   12. Improved Subscription & Billing by enhancing openBillingPortal with clear error handling for unconfigured Stripe portal and added a loading state in the button.
   13. Reviewed backend API createBillingPortalSessionForBusiness, suggested better return_url and error responses, and identified that Stripe Customer Portal setup in test mode is required.
   14. Removed Card Height Bug from the index page, the card with more content get's more height and the card with less content get's less height.

09-09-2025 (CrownStandard)

   1. Project env set up (new repo, Next.js, TypeScript, ESLint rules).
   2. TailwindCSS + PostCSS configured and working with brand CSS variables.
   3. Global design tokens wired to Tailwind (bg-background, text-foreground, etc.).
   4. Header component created and sized to match design.
   5. Reusable CTAButton added; consistent lucide-react icon usage.
   6. Home page (app/page.tsx) implemented per design.
   7. “How to Get Started” page (app/how-to-get-started/page.tsx) implemented with sections, steps, icons, FAQ.
   8. FAQ accordion upgraded with chevron toggle and section grouping.
   9. ESLint configured globally (disabled react/no-unescaped-entities), cleaned unused imports.
   10. Production build completed successfully and prepared for push and Deployed the Project in the netlify.

10-09-2025

   1. Merged plan limits into business data: After fetching, we inject imageLimit and videoLimit from the subscription plan directly into the returned business object so downstream components can read limits from props without re-checking the plan.
   2. Enforced upload caps for media: Image/video inputs now respect imageLimit/videoLimit by slicing extra files and warning the user, preventing overflows in state and accidental over-uploads.
   3. Hardened video upload function: The video handler specifically enforces the limit, converts blob URLs to files when needed, and resets the input so users can reselect the same files—this avoids stale selections and UX glitches.
   4. Decimal-friendly pricing inputs: Price and sale price now use type="number" with step="0.01" and min="0", which lets users enter decimals reliably while keeping our model typed as numbers and compatible with backend validation.
   5. Validation aligned with numeric types: The submit validator uses numeric checks (Number(...) + Number.isFinite) and enforces rules like “sale price must be less than price” and “each variant must have at least one image,” preventing bad payloads.
   6. Floating label UX for fields: Price, sale price, stock, size, and SKU inputs were converted to floating labels using the peer placeholder trick, so labels remain visible on focus and values, improving clarity and reducing placeholder flicker.
   7. Zero-display tweak for price: When the price is exactly 0, the input renders an empty string (instead of “0”) to avoid confusion during entry while still storing 0 correctly when applicable.
   8. Enforced image/video limits on the Service creation page by enhancing its handleFileUpload to respect imageLimit/videoLimit.
   9. Wired Google Places Autocomplete (REST v1) for the Street Address field: debounce, suggestions dropdown, details fetch, and auto-fill for city/state/zip/country.
   10. Fixed the Places API sessionToken issue by sending it as a string (not an object) and passing it on the Place Details URL.
   11. Ensured address auto-fill updates all fields at once by writing to a single setAddressFields(...).
11-09-2025

   1. Single-string address stored; commas disallowed.
   2. Parser on edit splits into addr1, addr2, city, state, zip, country (country last → zip → state → city).
   3. Three entry modes: manual, autocomplete, current location (reverse-geocode fills text only).
   4. Frontend clears coords on text change and sends `[0,0]` when no coordinates.
   5. Backend createService: accepts non-zero coords; otherwise geocodes `contact.address`.
   6. Backend updateService: ignores incoming coords; if address text changed, forward-geocodes and updates location.
   7. Use Current Location flow: geolocation → reverse-geocode → fill fields → store formatted address → set coords to `[0,0]`.
   8. Google Places Autocomplete iplemented with debounce, session token, and place details mapping into our fields.
   9. Built googlePlaces util with: dynamic script loader, session token handling, getPlaceSuggestions, getPlaceDetails, reverseGeocode, and geocodeByPostalCode.
   10. Integrated this util into your business registration form page.
   11. Added local state to hold address suggestions and dropdown visibility.
   12. Enhanced handleChange to fetch and show suggestions when typing in the address field.
   13. Created handlePickAddressSuggestion to fetch place details and auto-fill address, city, state, country.
   14. Updated the address input in your mapped fields to show a clickable suggestions dropdown.

12-09-2025

   1. Fixed issues related to displaying videos and images in product galleries, ensuring proper video handling and thumbnails.
   2. Implemented a solution where a square thumbnail with a play icon appears for videos, and clicking it opens the video in a large player.
   3. Resolved the issue where changing the product variant didn't update the video thumbnail correctly.
   4. Ensured that video thumbnails and main images switch correctly when variants change.
   5. Modified the backend API to exclude orders with status: "created" while still respecting any status filter query parameter passed by the user.
   6. Implemented the logic to control video playback with a play/pause toggle, without showing the default video controls.
   7. Fixed the video thumbnail issue with the play/pause icon by ensuring it resets on variant change.
   8. Migrated to the Mosaic domain.
   9. Updated the user controller for the new domain to ensure the cookie works.
   10. Made other required changes such as updating environment variables and changing the return URL.

1. Slug → ID in backend: Controller now accepts categorySlug/subcategorySlug, looks up Mongo _id from your ProductCategory/ProductSubcategory models, then calls the existing service unchanged.
2. Dynamic route on frontend: Read [productid] from the URL with useParams() and pass it as categorySlug so /furniture fetches that category directly.
3. Fixed API call: Corrected path to /api/products/ranked and normalized NEXT_PUBLIC_API_BASE_URL (no double slashes); added query params via URLSearchParams.
4. Grid wired to API: Replaced local JSON filter with a fetch to your RankedResponse; lightly filter client-side by price/brand before rendering.
5. Accurate discount badge: Recomputed % off as ((price - sale)/price)100 (no integer rounding) and formatted to 1 decimal only when needed (e.g., -0.5%).
6. Card UX polish: Kept drag-safe Swiper (no accidental clicks), clamped title/description lines, and showed price/rating consistently; optional sale badge appears when onSale is true.
7. Added Finance link to Sidebar (partner dashboard) pointing to /partners/[businessId]/finance.
8. Created Finance page (finance/page.tsx) with embedded Stripe Connect components: Payments + Payouts.
9. Styled Finance page: quick stats cards (Next Payout (ETA), Available Balance, Pending Balance) and a sticky “Open Connect Dashboard” button.











mosaic-biz-hub : Added Finance link to Sidebar (partner dashboard) pointing to /partners/[businessId]/finance, Created Finance page (finance/page.tsx) with embedded Stripe Connect components: Payments + Payouts, Styled Finance page: quick stats cards (Next Payout (ETA), Available Balance, Pending Balance) and a sticky “Open Connect Dashboard” button, Wired Finance page to external backend (apiBase) and added guards to prevent init before business data is ready, Implemented Finance backend endpoints used by the page: POST /stripe/account-session (Connect AccountSession client secret for components), GET  /stripe/account-balance?account=..., GET  /stripe/last-payout?account=..., POST /stripe/express-login-link (opens Connect Dashboard) Fixed JSON/content-type issues and added withCredentials where needed for external API calls, Explained/test-mode behavior for balances and U.S. default payout timing (T+2 business days), Added stripeCustomerId to Business model (+ index).







mosaic-biz-hub : Fixed issues related to displaying videos and images in product galleries, ensuring proper video handling and thumbnails, Implemented a solution where a square thumbnail with a play icon appears for videos, and clicking it opens the video in a large player, Resolved the issue where changing the product variant didn't update the video thumbnail correctly, Ensured that video thumbnails and main images switch correctly when variants change, Modified the backend API to exclude orders with status: "created" while still respecting any status filter query parameter passed by the user,Implemented the logic to control video playback with a play/pause toggle, without showing the default video controls, Fixed the video thumbnail issue with the play/pause icon by ensuring it resets on variant change, Migrated to the Mosaic domain, Updated the user controller for the new domain to ensure the cookie works, Made other required changes such as updating environment variables and changing the return URL ,Stripe Webhook endpoint updated with new url endpoint, removed cors error in the new domain.



mosaic-biz-hub : Standardized cookies (token, user_session, user_gender) and fixed multi–Set-Cookie issue (Domain Change), Introduced strong password validation on registration for vendor and customer, Added show/hide eye toggle for password fields, Met with Rakesh Sir; concluded there’s an issue in the business flow, Extracted application design and handed off to the Figma designer.



1. Implemented multi-step business registration form structure
2. Added left-side image section with responsive alignment
3. Applied smooth slide-in animations for each step (basic, address, compliance, categories)
4. Fixed layout shifting by using fixed-height container and `absolute` positioning
5. Reworked layout to allow dynamic height growth instead of forced min-height (removed scrollbars on mobile)
6. Added staggered animations and hover effects for plan selection cards
7. Added animated tab transitions for “Choose a Plan” and “Existing Plan” headings
